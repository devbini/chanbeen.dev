---
id: 4
title: "Docker ê¸°ë°˜ Redis Clusterì— Lettuce ì ‘ì†ì´ ì‹¤íŒ¨í•œ ì´ìœ ?"
date: '2025-07-29'
excerpt: 'Window ê¸°ë°˜ Docker í™˜ê²½ë¶€í„° VMê¹Œì§€ì˜ í•´ê²° ê³¼ì •ì„ ì •ë¦¬í•´ë´¤ìŠµë‹ˆë‹¤. . .'
tags: ['Tech', 'Redis', 'Docker', 'VM']
thumbnail: '/4/1.png'
---

## ë“¤ì–´ê°€ë©°
ì•ˆë…•í•˜ì„¸ìš”,  
í”„ë¡œì íŠ¸ ì§„í–‰ ì¤‘, **Redis í´ëŸ¬ìŠ¤í„° ì—°ê²° í…ŒìŠ¤íŠ¸ê°€ í•„ìš”í–ˆìŠµë‹ˆë‹¤.**  
JAVA ê¸°ë°˜ Spring í”„ë¡œì íŠ¸ì—ì„œ **Lettuceë¥¼ í†µí•´** í´ëŸ¬ìŠ¤í„°ì— ì—°ê²°í•´ì•¼ í•˜ëŠ” ìƒí™©ì´ì—ˆì–´ìš”.  

ê¸°ë³¸ì ì¸ Standalone RedisëŠ” RedisClientë¡œ ì‚¬ìš©í•˜ê²Œ ë˜ì§€ë§Œ,  
Cluster Redisì˜ ê²½ìš° **RedisClusterClient**ë¡œ, ë‹¤ë¥¸ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.  

ê·¸ë˜ì„œ ì‘ì—… PC ë‚´ ì—¬ëŸ¬ ê°œì˜ Redis ì¸ìŠ¤í„´ìŠ¤ë¥¼ Dockerë¡œ êµ¬ì„±í•˜ê³ ,  
í´ëŸ¬ìŠ¤í„°ë¡œ êµ¬ì„±í•˜ì—¬ Lettuceë¥¼ í†µí•´ ì—°ê²°í•´ë³´ë ¤ í–ˆìŠµë‹ˆë‹¤.  

í•˜ì§€ë§Œ... **Dockerë¡œ êµ¬ì„±í•œ Redis ClusterëŠ” Lettuce ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.**  
ê·¸ ì´ìœ ì™€ í•´ê²° ê³¼ì •ì„ ì •ë¦¬í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.  

### ì„  ê²°ë¡  (Window ê¸°ì¤€)

| ë°©ì•ˆ | 	í´ëŸ¬ìŠ¤í„° ê²°ì„± | Lettuce | ì—°ê²°	ì£¼ìš” ì‹¤íŒ¨ ì›ì¸                            |
|-----|--------|--------|----------------------------------------|
|Bridge network| ê°€ëŠ¥ | ì‹¤íŒ¨     | í´ëŸ¬ìŠ¤í„° í† í´ë¡œì§€ê°€ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ IPë¡œ ë…¸ì¶œ                   |
|Host network| ë¶ˆê°€ | -      | 	Window Docker Desktop ì œì•½              |
|cluster-announce| ë¶ˆê°€ | -      | ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ í˜¸ìŠ¤íŠ¸ ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼ ë¶ˆê°€ (network: Bridge) |
|host.docker.internal| ë¶ˆê°€ | - | cluster-announce ì„¤ì • ë¶ˆê°€   |
|VM(ë¦¬ëˆ…ìŠ¤ í˜¸ìŠ¤íŠ¸)| ê°€ëŠ¥ | ì„±ê³µ     | ë„¤íŠ¸ì›Œí¬ ë¶„ë¦¬ ì—†ì´ host IP ì§ì ‘ ì‚¬ìš©               |

---

## 1. ëª©í‘œ ë° ê°€ì„¤

### ê°€ìš© ìì› íŒŒì•…
ë¨¼ì € í˜„ì¬ í•˜ë“œì›¨ì–´ ìƒíƒœë¥¼ ì •ë¦¬ í•´ ë³´ê² ìŠµë‹ˆë‹¤.

- PC 1ëŒ€
- ê°œë°œ ë‚´ë¶€ë§ (ì™¸ë¶€ ì¸í„°ë„· ë¶ˆê°€)
- Docker, VMWare ì„¤ì¹˜ ë˜ì–´ìˆìŒ

### ìµœì¢… ëª©í‘œ
**JAVA ì•±ì—ì„œ Lettuceë¥¼ í†µí•´ í´ëŸ¬ìŠ¤í„°ì— ì—°ê²°ì´ ë˜ëŠ”ì§€** í…ŒìŠ¤íŠ¸í•´ì•¼ í•©ë‹ˆë‹¤.  
ì´í›„, RedisClusterCommand ê°ì²´ë¥¼ í†µí•´ **CLUSTER INFO** ê²°ê³¼ë¥¼ *ë°˜í™˜*ë°›ëŠ” ê²Œ ëª©í‘œì…ë‹ˆë‹¤.

### ëª©í‘œ ì„±ì·¨ ê°€ì„¤

1. Docker-Composeë¥¼ í†µí•´ Redis Containerë¥¼ 7ëŒ€ ìƒì„±
2. Redisì˜ ReplicaëŠ” 1ë¡œ ì„¤ì •, Master Node 3, S 4ê°œë¡œ êµ¬ì„±
3. ê° ì»¨í…Œì´ë„ˆëŠ” Bridge Networkë¡œ ì—°ê²°
4. redis-cli --cluster createë¡œ ì»¨í…Œì´ë„ˆ ì´ë¦„ìœ¼ë¡œ ì—°ê²°

ìœ„ì˜ ìˆœì„œë¡œ ì‘ì—…ì„ ì§„í–‰í•˜ë©´,  
**ëª¨ë“  Redis containerëŠ” í´ëŸ¬ìŠ¤í„°ë¡œ êµ¬ì„±ë˜ì–´**  
**í˜¸ìŠ¤íŠ¸ì—ì„œ íŠ¹ì • ë…¸ë“œì— ì—°ê²°ì„ ì‹œë„í–ˆì„ ë•Œ ëª¨ë“  í† í´ë¡œì§€ê°€ ìë™ ì—°ê²° ë  ê²ƒ**ì´ë¼ ìƒê°í–ˆìŠµë‹ˆë‹¤.  

---

## 2. ì²«ë²ˆì§¸ í…ŒìŠ¤íŠ¸ (Bridge Network í™œìš©)
- í•˜ë“œì›¨ì–´: Windows ë‹¨ì¼ PC
- Docker-composeë¡œ Redis ë…¸ë“œ 7ê°œë¥¼ êµ¬ì„±(bridge/host ë„¤íŠ¸ì›Œí¬ ë¹„êµ)

### Docker-Compose ì…‹ì—…
```yaml
version: "3"
services:
  redis-node-1:
    image: redis:latest
    container_name: redis-node-1
    command: redis-server --port 6379 --cluster-enabled yes --cluster-config-file nodes.conf --cluster-node-timeout 5000 --appendonly yes --bind 0.0.0.0
    ports:
      - "7001:6379"
    networks:
     - redis_cluster_net

  redis-node-2:
    image: redis:latest
    container_name: redis-node-2
    command: redis-server --port 6379 --cluster-enabled yes --cluster-config-file nodes.conf --cluster-node-timeout 5000 --appendonly yes --bind 0.0.0.0
    ports:
     - "7002:6379"
    networks:
     - redis_cluster_net

  ... (redis-node-7ê¹Œì§€ ë°˜ë³µ)

networks:
  redis_cluster_net:
    driver: bridge
```

**ì¶”ê°€ë¡œ, í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•  ìƒì„±ìš© ì»¨í…Œì´ë„ˆë¥¼ ì¶”ê°€ ì •ì˜í–ˆìŠµë‹ˆë‹¤.**
```yaml
  redis-cluster-creator:
    image: redis:latest
    container_name: cluster-creator
    networks:
      - redis_cluster_net
    depends_on:
      - redis-node-1
      - redis-node-2
      - redis-node-3
      - redis-node-4
      - redis-node-5
      - redis-node-6
      - redis-node-7
    command: redis-cli --cluster create redis-node-1:6379 redis-node-2:6379
          ... (ë°˜ë³µ)
          --cluster-replicas 1
          --cluster-yes
```

ì´í›„, `docker-compose up` ì„ í†µí•´ ë¡œê·¸ì™€ í•¨ê»˜ ë‚´ìš©ì„ í™•ì¸í•©ë‹ˆë‹¤.

![Docker compose up ë¡œê·¸ í™”ë©´](/4/2.png)

ë‚´ë¶€ Bridgeë¡œ ì—°ê²°ë˜ì–´ìˆê¸° ë•Œë¬¸ì—, ë‹¤ë¥¸ nodeë¡œì˜ ì—°ê²°ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.  
`redis-cli -h 172.20.0.2 -p 6379` ì´ëŸ° ë°©ì‹ìœ¼ë¡œ, ì ‘ì†ì´ ê°€ëŠ¥í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

### Lettuce JAVA ì•±
ì´ì œ, Lettuceê¸°ë°˜ JAVA ì•± ì½”ë“œë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.
```java
    public static void main(String[] args) {
        SpringApplication.run(LettuceApplication.class, args);

        RedisClusterClient clusterClient = RedisClusterClient.create(
                "redis://127.0.0.1:7001"
        );

        try (StatefulRedisClusterConnection<String, String> connection = clusterClient.connect()) {
            RedisClusterCommands<String, String> commands = connection.sync();
            StringListOutput<String,String> output = new StringListOutput<>(StringCodec.UTF8);

            CommandArgs<String, String> arg = new CommandArgs<>(StringCodec.UTF8).add("INFO");
            List<String> res = commands.dispatch(CommandType.CLUSTER, output, arg);

            System.out.println(res);
        }
        clusterClient.shutdown();
    }
```

ê°„ë‹¨í•˜ê²Œ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.  
redisì— ì—°ê²°í•œ í›„, Cluster Info ë©”ì‹œì§€ë¥¼ ë‚ ë¦½ë‹ˆë‹¤.  

### ê²°ê³¼
![connection failed ì˜¤ë¥˜ ì´ë¯¸ì§€](/4/3.png)

`connection timed out after 10000 ms: /172.20.0.7:6379`  
ìœ„ ë¡œê·¸ì²˜ëŸ¼, `Unable to connect`ë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤.  
ê°€ì¥ í° ë¬¸ì œëŠ”, **Lettuceì—ì„œ ì—°ê²°í•˜ë ¤ëŠ” ëŒ€ìƒ**ì´ `172.20.0.7:6379` ì¸ ê²ƒìœ¼ë¡œ íŒë‹¨í–ˆìŠµë‹ˆë‹¤.  

í•´ë‹¹ ì£¼ì†ŒëŠ” `docker network inspect dca_redis_cluster_net` ëª…ë ¹ì–´ë¥¼ í†µí•´  
**Docker ë‚´ë¶€ ì»¨í…Œì´ë„ˆ ì „ìš© IP**ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì§€ìš”.  

```yaml
> docker network inspect dca_redis_cluster_net

  [
    {
      "Name": "dca_redis_cluster_net",

      ...(ìƒëµ)

      "IPAM": {
        "Driver": "default",
        "Options": null,
        "Config": [
          {
            "Subnet": "172.20.0.0/16",
            "Gateway": "172.20.0.1"
          }
        ]
      },

      ...(ìƒëµ)

      "Containers": {
        "17151efcca8b5e326536717daf4712edfd1d47eaa883accdca409b081a5eb730": {
          "Name": "redis-node-3",
          "EndpointID": "d7379693b4eea17d36e4988ae2ecc1dac606aa378021eaf26b49640965c1b672",
          "MacAddress": "02:42:ac:14:00:02",
          "IPv4Address": "172.20.0.2/16",
          "IPv6Address": ""
        },
        "47db6a380c842f091bd7bb726cf6ff1bcf560d58150a5a85f70101cb82302daf": {
          "Name": "redis-node-7",
          "EndpointID": "9829afd2d94f1d9e77e893582ff39f84018c8830b25a076bf092c64735815c36",
          "MacAddress": "02:42:ac:14:00:05",
          "IPv4Address": "172.20.0.5/16",
          "IPv6Address": ""
        },

      ... (ì´í•˜ ìƒëµ)
```

ê·¸ëŸ¼ ë‹¤ì‹œ ëŒì•„ê°€ì„œ, **172.20.0.xëŠ” ë„ì»¤ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì„œë¸Œë„· IPì…ë‹ˆë‹¤.**  
í˜¸ìŠ¤íŠ¸, ë„ì»¤ ì»¨í…Œì´ë„ˆ ì™¸ë¶€ì—ì„  ì ‘ê·¼í•  ìˆ˜ ì—†ëŠ” ì£¼ì†Œì´ì£ .  

í˜¸ìŠ¤íŠ¸ì—ì„œ ì ‘ê·¼í•˜ë ¤ë©´ localhost:<PORT> ë¡œ ì ‘ê·¼í•´ì•¼ í•˜ë©°.  
dockerì—ì„œ portsë¡œ í¬íŠ¸í¬ì›Œë”©í•œ ìœ„ì¹˜ë¡œ ì ‘ê·¼í•´ì•¼ í•´ë‹¹ ë…¸ë“œë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.  

**ê·¸ëŸ¼, ì™œ LettuceëŠ” í† í´ë¡œì§€íƒìƒ‰ì— ë„ì»¤ ë‚´ë¶€ ì»¨í…Œì´ë„ˆ ì£¼ì†Œë¥¼ ì“¸ê¹Œ?**  

---

## 3. Lettuceì˜ í´ëŸ¬ìŠ¤í„° íƒìƒ‰ ë°©ì‹?

LettuceëŠ” ìµœì´ˆë¡œ í•œ ë…¸ë“œì— ì ‘ì†í•˜ê²Œ ë˜ë©´,  
**ìë™ìœ¼ë¡œ CLSUTER SLOTSì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.**  

```yaml
127.0.0.1:6379> CLUSTER SLOTS

1) 1) (integer) 0
   2) (integer) 5460
   3) 1) "172.20.0.7"
      2) (integer) 6379
      3) "cdc471c93bff4771944f8c936c552be18ec7541c"
      4) (empty array)
   4) 1) "172.20.0.3"
      2) (integer) 6379
      3) "ff4793dd3ea08102af6a081df3e1ad7abc2c16c1"
      4) (empty array)
   5) 1) "172.20.0.6"
```

ì—¬ê¸°ì„œ ê²€ìƒ‰ ëœ IPë¡œ LETTUCEì—ì„œ ìë™ ê²€ìƒ‰ì„ ìˆ˜í–‰í•˜ëŠ”ë°,  
ëª¨ë‘ ë„ì»¤ ë‚´ë¶€ IPì„ì„ í™•ì‹¤íˆ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ Lettuceê°€ í†µì‹  ì—°ê²°ì„ ì‹œë„í•˜ê¸° ë•Œë¬¸ì—,  
í˜¸ìŠ¤íŠ¸ì—ì„œëŠ” ë„ì»¤ ë‚´ë¶€ IPë¡œ ì ‘ì†í•  ìˆ˜ ì—†ëŠ” ìƒí™©ì´ ë²Œì–´ì§„ ê²ƒì´ì£ ...  

---
## 4. ë‘ë²ˆì§¸ ë°©ì•ˆ (Host Network í™œìš©)

### ê°€ì„¤
ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ í•  ìˆ˜ ìˆëŠ” ê±¸ ìƒê°í•´ë´¤ì„ ë•Œ...   
**Docker-Bridgeë¡œ í•˜ë©´ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ë¡œ ì¡ìœ¼ë‹ˆ,**  
**Host ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ë„ë¡ í•˜ê³ , ê° ì»¨í…Œì´ë„ˆë¥¼ ë‹¤ë¥¸ í¬íŠ¸ë¡œ ì‹¤í–‰ì‹œí‚¤ë©´ ë˜ì§€ ì•Šì„ê¹Œ?**  
í•˜ëŠ” ê°€ì„¤ì„ ì„¸ì› ìŠµë‹ˆë‹¤.  

- Host ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©
- ê° Redis Cluster ì‹¤í–‰ í¬íŠ¸ë¥¼ ë³€ê²½

### ê²°ê³¼ (í•œê³„)
**Window Dockerì—ì„œëŠ” network Hostë¥¼ ë³„ë„ ì„¤ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.**  
> ê°œë°œ PCì—ì„œëŠ” êµ¬ë™ì¤‘ì¸ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆë“¤ì´ ìˆì–´,  
> ì¼ê´„ ë³€ê²½ë˜ëŠ” Docker Desktopì˜ Host ì„¤ì • í™œì„±í™”ëŠ” ë¬´ë¦¬ê°€ ìˆìŠµë‹ˆë‹¤.

Linux í™˜ê²½ì—ì„œëŠ” ì¶©ë¶„íˆ ê°€ëŠ¥í•˜ë‹¤ ìƒê°í•©ë‹ˆë‹¤.  
ì´ë¥¼ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´, linuxì—ì„œ hostë¡œ REDISë“¤ì„ ì‹¤í–‰ì‹œí‚¨ í›„  
íŠ¹ì • ë…¸ë“œì—ì„œ `redis-cli -h 127.0.0.1 -p <ë‹¤ë¥¸ REDIS ì»¨í…Œì´ë„ˆ í¬íŠ¸>`ë¡œ  
ì ‘ì†ì´ ê°€ëŠ¥í•˜ë©´ ì•„ë§ˆ ë¬¸ì œì—†ì´ ë  ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.  

**í•˜ì§€ë§Œ... ì €ëŠ” Window í™˜ê²½ì´ê³ , ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.**  
ë¬¼ë¡ , Docker-in-Dockerë¡œ Rocky Linux ë“±ì„ ì„¤ì¹˜í•´ì„œ redisë¥¼ êµ¬ë™ì‹œí‚¤ëŠ” ê²ƒë„ ë°©ë²•ì´ì£ .  
ê·¸ë˜ë„ ê¹”ë”í•˜ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ê³  ì‹¶ì—ˆì–´ìš”. 

---

## 5. ì„¸ë²ˆì§¸ ë°©ì•ˆ (cluster-announce-ip í™œìš©)

### announce ì„¤ì • ì‹œë„
ì´ê²ƒë„ Host-Networkì™€ ë¹„ìŠ·í•œ ë¬¸ì œì…ë‹ˆë‹¤.  
```yaml
  redis-node-1:
    image: redis:latest
    container_name: redis-node-1
    command: redis-server --port 6379 --cluster-enabled yes --cluster-config-file nodes.conf --cluster-node-timeout 5000 --appendonly yes --bind 0.0.0.0 --cluster-announce-ip 127.0.0.1 --cluster-announce-port 7001 
    ports:
      - "7001:6379"
```

ì´ëŸ°ì‹ìœ¼ë¡œ, redis ì„œë²„ ìƒì„± ì‹œ cluster-announce-ë¥¼ ì…ë ¥í•˜ì—¬  
ë³¸ì¸ì˜ ì›ê²© ì£¼ì†Œë¥¼ ì…ë ¥í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

í•˜ì§€ë§Œ... ì—­ì‹œ ë™ì¼í•˜ì£ . **ë¸Œë¦¿ì§€ë¡œ êµ¬ë™ë˜ëŠ” ì„œë²„ì´ê¸° ë•Œë¬¸ì—**,  
containerì— ë“¤ì–´ê°€ì„œ í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•˜ë ¤ í•˜ë©´,  
```shell
root@ddfabbf00ab4:/data# redis-cli --cluster create 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 127.0.0.1:7006 127.0.0.1:7007 --cluster-replicas 1
Could not connect to Redis at 127.0.0.1:7001: Connection refused
```

ì´ëŸ° ì—ëŸ¬ê°€ ë‚˜ì˜¬ê²ë‹ˆë‹¤.  
**cluster-announce ìì²´ëŠ” Redis ì„¤ì •ìƒ ê°€ëŠ¥í•˜ì§€ë§Œ,**  
**Docker Bridge ë„¤íŠ¸ì›Œí¬ íŠ¹ì„±ìƒ í˜¸ìŠ¤íŠ¸ IPë¡œì˜ ì—°ê²°ì€ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ì œí•œë©ë‹ˆë‹¤.**  
ì´ë ‡ê²Œ ë˜ë©´, ë‹¹ì—°í•˜ê²Œë„ í´ëŸ¬ìŠ¤í„° êµ¬ì„± ìì²´ê°€ ë¶ˆê°€í•©ë‹ˆë‹¤.

### ê·¸ëŸ¼, host.docker.internalì„ ì‚¬ìš©í•˜ë©´ ë˜ì§€ ì•Šë‚˜?
> host.docker.internalì€ Docker ì»¨í…Œì´ë„ˆì—ì„œ í˜¸ìŠ¤íŠ¸ ë¨¸ì‹ ìœ¼ë¡œ ì ‘ê·¼í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë…¼ë¦¬ìƒ network ì„¤ì •ì„ hostë¡œ ì…ë ¥í•˜ê³  ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ ë‹¤ë¥¼ ê²Œ ì—†ì£ .  

*í•˜ì§€ë§Œ*  
Redis í´ëŸ¬ìŠ¤í„°ì— ë³¸ì¸ìœ¼ë¡œ ì ‘ì†í•˜ê¸° ìœ„í•œ IPë¥¼ ì„¤ì •í•˜ëŠ” cluster-announce-ipëŠ” IP ì •ê·œì‹ë§Œ í—ˆìš©í•©ë‹ˆë‹¤.  
`--cluster-announce-ip host.docker.internal` ì…ë ¥ì„ í•´ ì£¼ë©´, ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.  
![host.docker.internal ì—ëŸ¬ ì´ë¯¸ì§€](/4/6.png)

ê·¸ë ‡ë‹¤ê³  cluster-announce-ipë¥¼ 127.0.0.1ë¡œ í•˜ë©´, ì»¨í…Œì´ë„ˆë§ˆë‹¤ ë„¤íŠ¸ì›Œí¬ê°€ ê³ ë¦½ë˜ëŠ” ê²°ê³¼ê°€ ë‚˜ì˜¬ ë¿ì…ë‹ˆë‹¤.  

---

## 6. ë§ˆì§€ë§‰ ë°©ì•ˆ (VM í™œìš©)
ìœˆë„ìš° í™˜ê²½ì—ì„œ ë³„ë„ OS ì„¤ì • ì—†ì´ ì§„í–‰í•˜ë ¤ë©´, ë„ì»¤ ì»¨í…Œì´ë„ˆë¡œëŠ” ì–´ë µë‹¤ëŠ” íŒë‹¨ì´ ì„°ìŠµë‹ˆë‹¤.  
- ë¦¬ëˆ…ìŠ¤ í™˜ê²½ì´ë¼ë©´ network - host ì„¤ì •ìœ¼ë¡œ ê°€ëŠ¥í•  ê²ƒìœ¼ë¡œ ë³´ì„.

![VM êµ¬ì„± ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤ ì´ë¯¸ì§€](/4/5.png)

### í™˜ê²½ ì„¤ì •
1. ì™¸ë¶€ë§ì—ì„œ Rocky-Linux Containerë¥¼ ìƒì„±.  
2. redis ì„¤ì¹˜ì— í•„ìš”í•œ rpm ì¶”ê°€. `dnf download --resolve --arch=x86_64 redis`  
3. ì´í›„ rpm íŒŒì¼ì„ ê°œë°œë§ ë‚´ë¶€ NAS ì„œë²„ë¡œ ì´ë™í•©ë‹ˆë‹¤.
4. ë‚´ë¶€ ê°œë°œë§, VMWareì—ì„œ Linuxë¥¼ êµ¬ë™í•©ë‹ˆë‹¤.
5. ê³µìœ  í´ë”ë¥¼ í†µí•´ rpmì„ ì „ë‹¬í•œ í›„, ì„¤ì¹˜í•©ë‹ˆë‹¤. `dnf --disablerepo="*" localinstall *.rpm --nogpgcheck`

### í´ëŸ¬ìŠ¤í„° ì…‹ì—…
1. ê° VMì— ì ‘ì†í•˜ì—¬ `/etc/redis.conf`ì˜ `bind`ê°’ì„ `0.0.0.0`ìœ¼ë¡œ í—ˆìš© ì²˜ë¦¬ í•´ ì¤ë‹ˆë‹¤.
2. ê° VMì˜ ë°©í™”ë²½ì— ì ‘ì†í•˜ì—¬ `6379`ì™€ `16379` í¬íŠ¸ë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.
3. `/var/lib/redis/nodes.conf`ê°€ VMë³„ë¡œ ë‹¤ë¥¸ ê°’ì´ ë“¤ì–´ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
4. í•œ VMì— ì ‘ì†í•˜ì—¬ `redis-cli --cluster create <VM-IP>:6379 ~ ë°˜ë³µ ~ --cluster-replicas 1 --cluster-yes` ë¡œ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.
5. CLUSTER INFOì—ì„œ cluster stateê°€ ONìœ¼ë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸í•˜ê³ , CLUSTER NODESê°€ ì •ìƒì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.

### ê²°ê³¼ (Lettuce ì—°ê²° í…ŒìŠ¤íŠ¸)
ì´í›„, í˜¸ìŠ¤íŠ¸ì—ì„œ ë‹¤ì‹œ Lettuceë¥¼ í†µí•´ create.connect.syncë¥¼ ì‹¤í–‰í•˜ë©´,  
ì •ìƒì ìœ¼ë¡œ ì—°ê²°ëœ í›„ ë°ì´í„°ë¥¼ ë°˜í™˜ë°›ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.  

![CLUSTER NODES ê²°ê³¼ ì´ë¯¸ì§€](/4/4.png)

Cluster INFOì— ëŒ€í•œ ê°’ë„ ì •ìƒì ìœ¼ë¡œ ë°˜í™˜ë˜ë„¤ìš”.  

---

## ë§ˆë¬´ë¦¬
ì—¬ëŸ¬ëª¨ë¡œ ì¬ë¯¸ìˆëŠ” í…ŒìŠ¤íŠ¸ì˜€ìŠµë‹ˆë‹¤.  
**í˜„ì¬ë„ ì¢€ ë” REDISë¥¼ JAVAì—ì„œ í•¸ë“¤ë§í•˜ê¸° ìœ„í•´ LETTUCEë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.**  
spring-boot-Redisë„ ê°€ëŠ¥ì€ í•˜ì§€ë§Œ, ì»¤ë§¨ë“œ stringì„ ì§ì ‘ êµ¬ë™ì‹œí‚¤ê¸°ì—ëŠ”  
lettuceê°€ ë” ì¢‹ë‹¤ íŒë‹¨í–ˆìŠµë‹ˆë‹¤.  

- Docker Bridgeë¡œ Redis Clusterë¥¼ êµ¬ì„±í•˜ë©´, **ì™¸ë¶€ì—ì„œ Lettuce ì—°ê²°ì€ ì‹¤íŒ¨**í•©ë‹ˆë‹¤.
- ê°€ì¥ í° ì›ì¸ì€ **CLUSTER SLOTS ê²°ê³¼ê°€ ë‚´ë¶€ IPë¥¼ ë°˜í™˜**í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
- Windows DockerëŠ” Host ë„¤íŠ¸ì›Œí¬ë¥¼ ë¶€ë¶„ì ìœ¼ë¡œ ì§€ì›í•˜ê¸° ë•Œë¬¸ì—, **VM ê¸°ë°˜ ë¦¬ëˆ…ìŠ¤ê°€ ì‚¬ì‹¤ìƒ ìœ ì¼í•œ ëŒ€ì•ˆ**ì´ì—ˆìŠµë‹ˆë‹¤.

ì•„ì§ ë¦¬ëˆ…ìŠ¤ ê¸°ë°˜ OSì—ì„œ ë„ì»¤ë¥¼ ì„¤ì¹˜í•œ ë’¤, host ê¸°ë°˜ìœ¼ë¡œ ë™ì‘ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ëŠ” ê±´  
ìˆ˜í–‰ë˜ì§€ ì•Šì•˜ì§€ë§Œ, Linux ê¸°ë°˜ì—ì„œëŠ” host network ì„¤ì •ì´ ììœ ë¡­ê¸° ë•Œë¬¸ì—  
ë¸Œë¦¿ì§€ ë„¤íŠ¸ì›Œí¬ì˜ ë¬¸ì œë¥¼ ê°œì„ í•  ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ìƒê°í•˜ê³  ìˆìŠµë‹ˆë‹¤.  
> **ë¹ ë¥¸ ì‹œì¼ ë‚´ì— í…ŒìŠ¤íŠ¸í•˜ì—¬ ê¸€ ìˆ˜ì •ì„ í•´ ë‘ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.** ğŸ˜Š  

í‹€ë¦° ë¶€ë¶„ì´ë‚˜ ë” ë³´ì™„í• ë§Œí•œ ë¶€ë¶„ì´ ìˆë‹¤ë©´,  
**ëŒ“ê¸€ ë¶€íƒë“œë¦½ë‹ˆë‹¤!**  

> ê°ì‚¬í•©ë‹ˆë‹¤.  